{
  "active" : true,
  "appType" : true,
  "ars_properties" : {
    "dataVersion" : 5,
    "graph" : {
      "lastZoomRequest" : 3,
      "scale" : 0.8106741531488469,
      "translate" : [ 159.1708032573189, 57.21910162213837 ]
    },
    "groupSettings" : {
      "appGroupOpenHash" : {
        "ServiceProcedures" : true,
        "component" : true,
        "serviceevents" : true
      },
      "ctGroupOpenHash" : {
        "actions" : true,
        "mobile" : true
      },
      "ctServiceOpen" : false,
      "serviceGroupOpenHash" : { }
    },
    "paletteWidth" : 170,
    "propertyWidth" : 280
  },
  "ars_relationships" : [ ],
  "assembly" : {
    "DetectMalfunction" : {
      "configuration" : {
        "MalfunctionDetected" : [ "EngineMalfunction" ],
        "TransformedEvent" : [ "OutboundTemp" ],
        "maxSpeed" : 45,
        "maxTemperature" : 100,
        "parentStreams" : [ ],
        "sensorProp" : "temperature",
        "transformation" : {
          "speed" : {
            "expression" : "event.speed",
            "type" : "expression"
          },
          "systemId" : {
            "expression" : "event.systemId",
            "type" : "expression"
          },
          "temperature" : {
            "expression" : "(event.temperature - 32) * (5/9)",
            "type" : "expression"
          }
        }
      },
      "downstreamReferences" : { },
      "downstreamUUIDS" : {
        "MalfunctionDetected" : "30f7bae3-d15d-4fea-923d-88275464de31",
        "TransformedEvent" : "f7a7191d-8ae6-4e33-8a30-3d7b28379785"
      },
      "isComponent" : true,
      "pattern" : "DetectMalfunction",
      "rootTask" : "DetectMalfunction_Transformation",
      "uuid" : "3e017767-930f-4781-b046-0ef6af7927b1"
    },
    "DetectMalfunction_SplitBySystemId" : {
      "componentReference" : "DetectMalfunction",
      "configuration" : {
        "childStreams" : [ "DetectMalfunction_UpdateState" ],
        "enableBadging" : true,
        "groupBy" : "event.systemId",
        "parentStreams" : [ "DetectMalfunction_Transformation" ]
      },
      "downstreamReferences" : { },
      "name" : "DetectMalfunction_SplitBySystemId",
      "pattern" : "SplitByGroup",
      "patternVersion" : 1
    },
    "DetectMalfunction_Transformation" : {
      "componentReference" : "DetectMalfunction",
      "configuration" : {
        "childStreams" : [ "OutboundTemp", "DetectMalfunction_SplitBySystemId" ],
        "enableBadging" : true,
        "parentStreams" : [ "EventStream" ],
        "transformInPlace" : false,
        "transformation" : {
          "speed" : {
            "expression" : "event.speed",
            "type" : "expression"
          },
          "systemId" : {
            "expression" : "event.systemId",
            "type" : "expression"
          },
          "temperature" : {
            "expression" : "(event.temperature - 32) * (5/9)",
            "type" : "expression"
          }
        },
        "upsert" : false
      },
      "downstreamReference" : "TransformedEvent",
      "downstreamReferences" : { },
      "isRoot" : true,
      "name" : "DetectMalfunction_Transformation",
      "pattern" : "Transformation",
      "patternVersion" : 1
    },
    "DetectMalfunction_UpdateState" : {
      "componentReference" : "DetectMalfunction",
      "configuration" : {
        "childStreams" : [ "DetectMalfunction_generateAlertMessage" ],
        "enableBadging" : true,
        "imports" : null,
        "outboundBehavior" : "Emit original event",
        "outboundProperty" : null,
        "parentStreams" : [ "DetectMalfunction_SplitBySystemId" ],
        "procedure" : {
          "vailScript" : "// If there wasn't a previous value for this id, create a new entry with the systemId\nif (!state) {\n    state = {systemId : event.systemId}\n}\n\n// If this event included a sensor reading, update the stored sensor reading\nif (event[\"temperature\"]) {\n    state[\"temperature\"] = event[\"temperature\"]\n}"
        },
        "schema" : null
      },
      "downstreamReferences" : { },
      "name" : "DetectMalfunction_UpdateState",
      "pattern" : "AccumulateState",
      "patternVersion" : 1
    },
    "DetectMalfunction_generateAlertMessage" : {
      "componentReference" : "DetectMalfunction",
      "configuration" : {
        "childStreams" : [ "DetectMalfunction_isMalfunctionDetected" ],
        "enableBadging" : true,
        "parameters" : {
          "maxSpeed" : 45,
          "maxTemp" : 100,
          "sensorEvent" : "event",
          "systemId" : "event.systemId"
        },
        "parentStreams" : [ "DetectMalfunction_UpdateState" ],
        "procedure" : "com.vantiq.engines.EngineMonitor.generateAlertMessage",
        "returnBehavior" : "Use Return Value as Outbound event"
      },
      "downstreamReferences" : { },
      "name" : "DetectMalfunction_generateAlertMessage",
      "pattern" : "Procedure",
      "patternVersion" : 1
    },
    "DetectMalfunction_isMalfunctionDetected" : {
      "componentReference" : "DetectMalfunction",
      "configuration" : {
        "childStreams" : [ "EngineMalfunction" ],
        "condition" : "event.alertMsg != null",
        "enableBadging" : true,
        "parentStreams" : [ "DetectMalfunction_generateAlertMessage" ],
        "upsert" : false
      },
      "downstreamReference" : "MalfunctionDetected",
      "downstreamReferences" : { },
      "name" : "DetectMalfunction_isMalfunctionDetected",
      "pattern" : "Filter",
      "patternVersion" : 1
    },
    "EngineMalfunction" : {
      "configuration" : {
        "parentStreams" : [ "DetectMalfunction_isMalfunctionDetected" ],
        "topic" : "/com.vantiq.engines.EngineMonitor/EngineMalfunction/outbound"
      },
      "downstreamReferences" : { },
      "pattern" : "PublishToTopic",
      "patternVersion" : 1,
      "uuid" : "f86ea40c-25a9-4bd2-80b7-6826c1f33342"
    },
    "EventStream" : {
      "configuration" : {
        "childStreams" : [ "DetectMalfunction" ],
        "inboundResource" : "topics",
        "inboundResourceId" : "/com.vantiq.engines.EngineMonitor/TempEvent/handler/inbound",
        "parentStreams" : [ ]
      },
      "downstreamReferences" : { },
      "pattern" : "EventStream",
      "patternVersion" : 1,
      "uuid" : "30793167-bcf1-4d14-89c5-644c28873fbf"
    },
    "OutboundTemp" : {
      "configuration" : {
        "parentStreams" : [ "DetectMalfunction_Transformation" ],
        "topic" : "/outbound/engine/temp"
      },
      "downstreamReferences" : { },
      "pattern" : "PublishToTopic",
      "patternVersion" : 1,
      "uuid" : "748a0fba-f45b-41c4-9286-bcf3e898e9d2"
    }
  },
  "boundService" : "com.vantiq.engines.EngineMonitor",
  "collaboratorRoles" : [ ],
  "disableBadging" : false,
  "entityRoles" : [ ],
  "isComponent" : false,
  "isEventHandler" : true,
  "keyTypes" : [ "system.collaborations" ],
  "name" : "com.vantiq.engines.EngineMonitor_TempEvent_EventHandler"
}